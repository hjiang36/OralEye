<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self'; style-src 'self';">
  <title>OralEye</title>
  <link href="node_modules/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <div class="container">
        <h1 class="mt-5">OralEye Device List</h1>
        <ul id="wifi-device-list" class="list-group mt-3"></ul>
        <button id="bt-scan-btn" class="btn btn-primary mt-3">Add New device</button>
        <ul id="device-list" class="list-group mt-3"></ul>

        <!-- New textbox and button -->
        <div class="mt-3">
            <input type="text" id="url-input" class="form-control" placeholder="Enter URL">
            <button id="redirect-btn" class="btn btn-primary mt-2">Redirect</button>
        </div>
    </div>
    <script src="node_modules/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
    <script src="./renderer.js"></script>
    <h1>Raspberry Pi Camera Stream</h1>
    <p id="ip-address">Fetching IP address...</p>
    <p id="stream-status">Checking stream status...</p>
    <img id="stream" style="display:none; width: 100%; max-width: 800px; height: auto;" src="" alt="Camera Stream">
    <script>
        async function checkStream(ip) {
            const url = `http://${ip}:8080`;
            const streamAvailable = await window.electron.checkStream(url);
            if (streamAvailable) {
                document.getElementById('stream-status').textContent = 'Stream is available';
                document.getElementById('stream').src = url;
                document.getElementById('stream').style.display = 'block';
            } else {
                document.getElementById('stream-status').textContent = 'Stream is not available';
            }
        }

        window.electron.getIPAddress().then(ip => {
            document.getElementById('ip-address').textContent = `IP Address: ${ip}`;
            checkStream(ip);
        }).catch(err => {
            console.error('Error fetching IP address:', err);
            document.getElementById('ip-address').textContent = 'Error fetching IP address';
        });
    </script>
</body>
</html>
